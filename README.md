# CookiesCrasher v1.0 🍪

**"تستغل الكوكيز، قضمة قضمة"**

`CookiesCrasher` هي أداة سطر أوامر مكتوبة بلغة Python، مصممة لاختبار أمان تطبيقات الويب ضد ثغرات اختطاف الجلسات (Session Hijacking) عن طريق تخمين قيم ملفات تعريف الارتباط (الكوكيز).

---

## ✨ نظرة عامة

تعمل الأداة على أتمتة عملية التحقق من صحة قائمة من قيم الكوكيز المحتملة مقابل نقطة نهاية (URL) محمية بجلسة. تعتمد فكرتها الأساسية على مقارنة حجم الاستجابة (content length) من الخادم:
1.  **إنشاء خط أساس (Baseline):** تقوم الأداة أولاً بإرسال طلب إلى الرابط المستهدف بدون أي كوكيز خاصة بالجلسة وتسجيل حجم الصفحة. هذه هي حالة "المستخدم غير المسجل".
2.  **الاختبار والمقارنة:** بعد ذلك، تقوم بتكرار قائمة من الكوكيز (إما من ملف أو قيمة واحدة) وإرسال طلب مع كل قيمة كوكي.
3.  **الكشف عن النجاح:** إذا كان حجم الصفحة المستلمة مختلفًا عن حجم خط الأساس، فمن المحتمل جدًا أن تكون قيمة الكوكي صحيحة وقد أدت إلى تسجيل الدخول وعرض صفحة مختلفة (مثل لوحة التحكم بدلاً من صفحة تسجيل الدخول).

هذه التقنية فعالة وبسيطة لاكتشاف الجلسات النشطة في حال كانت قيم الكوكيز قابلة للتخمين.

## 🚀 الميزات

-   **وضعان للتشغيل:** فحص قيمة كوكي واحدة، أو الهجوم بقائمة كلمات (Wordlist).
-   **اسم كوكي مخصص:** يمكنك تحديد اسم الكوكي المستهدف (الافتراضي هو `sessionid`).
-   **حفظ النتائج:** حفظ الكوكيز الصحيحة التي تم العثور عليها تلقائيًا في ملف إخراج.
-   **واجهة تفاعلية:** استخدام ألوان وشريط تقدم (`tqdm`) لتجربة مستخدم واضحة وجذابة.
-   **وضع مطوّل (Verbose):** عرض جميع محاولات الفحص (الناجحة والفاشلة) لمزيد من التفاصيل.
-   **سهولة الاستخدام:** معلمات واضحة وأمثلة عملية مدمجة.

## 📋 المتطلبات

لعمل الأداة، يجب أن تكون المكتبات التالية مثبتة في بيئة بايثون الخاصة بك:
-   `requests`
-   `colorama`
-   `tqdm`

## 🛠️ التثبيت

1.  **استنسخ المستودع (أو قم بحفظ الكود في ملف):**
    ```bash
    # إذا كان المستودع على GitHub
    git clone https://github.com/user/CookiesCrasher.git
    cd CookiesCrasher
    ```
    أو ببساطة، احفظ الكود المصدري في ملف باسم `cookiescrasher.py`.

2.  **ثبّت المكتبات المطلوبة:**
    أنشئ ملف `requirements.txt` وضع فيه التالي:
    ```
    requests
    colorama
    tqdm
    ```
    ثم قم بتثبيتها باستخدام `pip`:
    ```bash
    pip install -r requirements.txt
    ```
    أو يمكنك تثبيتها مباشرة:
    ```bash
    pip install requests colorama tqdm
    ```
---

## 📖 طريقة الاستخدام

يمكنك عرض جميع خيارات الأداة باستخدام المعلمة `-h` أو `--help`.

```bash
python3 cookiescrasher.py -h
```

### الخيارات المتاحة:
| المعلمة          | الوصف                                                          | مطلوب؟     |
|------------------|------------------------------------------------------------------|-----------|
| `-u`, `--url`    | الرابط المستهدف الذي سيتم اختبار الكوكيز عليه.                      | **نعم**   |
| `-c`, `--cookie` | قيمة كوكي واحدة ليتم اختبارها.                                       | نعم (أو -w)|
| `-w`, `--wordlist` | مسار ملف يحتوي على قائمة من قيم الكوكيز (كل قيمة في سطر).     | نعم (أو -c)|
| `-n`, `--name`   | اسم الكوكي المستخدم (الافتراضي: `sessionid`).                        | لا        |
| `-o`, `--output` | اسم ملف لحفظ النتائج الصحيحة فيه.                                 | لا        |
| `-v`, `--verbose`| تفعيل الوضع المطوّل لعرض جميع المحاولات (الناجحة والفاشلة).        | لا        |

---

## 💡 أمثلة على الاستخدام

#### 1. فحص قيمة كوكي واحدة

لفحص ما إذا كانت قيمة كوكي معينة صالحة لصفحة ملف شخصي.

```bash
python3 cookiescrasher.py -u "https://example.com/profile" -c "xyzabc123"
```

#### 2. الهجوم بقائمة كلمات واسم كوكي مختلف

للهجوم على لوحة تحكم باستخدام قائمة من الكوكيز مخزنة في ملف `cookies.txt`، مع تحديد أن اسم الكوكي هو `PHPSESSID`، وحفظ النتائج في `valid.txt` وعرض جميع المحاولات.

```bash
python3 cookiescrasher.py -u "https://vuln.site/admin" -w cookies.txt -n "PHPSESSID" -o valid.txt -v
```
---
## ✍️ المؤلف

تم تطوير هذه الأداة بواسطة **blue24bluer**.
